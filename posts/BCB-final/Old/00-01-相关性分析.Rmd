library(readxl)

## 相关性分析
## 不同年份相关性分析
# 读取数据
data <- read.csv("YLD.csv")

# 将所有以YLD开头的列转换为double类型
data[grepl("^YLD", names(data))] <- lapply(data[grepl("^YLD", names(data))], as.numeric)

# 选择YLD的列 #要更改
ALL_cols <- data[, 3:ncol(data)]  # 假设YLD数据从第4列开始

# 处理缺失值（如果有）
for(i in 1:ncol(data)) {
  if(is.numeric(data[[i]])) {  # 确保只对数值型列操作
    data[[i]][is.na(data[[i]])] <- mean(data[[i]], na.rm = TRUE)
  }
}


# 计算相关性矩阵
cor_matrix <- cor(ALL_cols, use = "complete.obs")

# 可视化相关性矩阵
corrplot::corrplot(cor_matrix, method = "color", addCoef.col = "black", tl.col = "black", tl.srt = 45)
