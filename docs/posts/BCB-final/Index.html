<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yaotian Gao">
<meta name="dcterms.date" content="2024-04-28">

<title>BCB-Quarto Blog - BCB 520 - Final project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">BCB-Quarto Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">BCB 520 - Final project</h1>
            <p class="subtitle lead">Genomic prediction of yield in diverse spring wheat lines across multiple environment</p>
                                <div class="quarto-categories">
                <div class="quarto-category">Genomic selection</div>
                <div class="quarto-category">yield prediction</div>
                <div class="quarto-category">spring wheat</div>
                <div class="quarto-category">multi-environment trials</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yaotian Gao </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 28, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">1. Preamble</a></li>
  <li><a href="#data-and-code" id="toc-data-and-code" class="nav-link" data-scroll-target="#data-and-code">2. Data and Code</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">3. Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">4. Conclusion</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">5. Reference</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="preamble" class="level1">
<h1>1. Preamble</h1>
<p>Wheat (<em>Triticum aestivum</em> L.), responsible for a significant portion of global caloric intake, is increasingly threatened by both natural and anthropogenic factors, including climate change and geopolitical unrest (Zhang et al.&nbsp;2022). These challenges underline the urgency for innovative approaches in wheat breeding, beyond the capabilities of traditional methods. Genomic Selection (GS) represents a transformative approach, leveraging high-throughput genotyping technologies to overcome the limitations of conventional breeding by enabling more precise genetic selection for desired traits(Heffner et al.&nbsp;2009).</p>
<p>Several factors can influence the prediction accuracy of GS models, including population structure, training population size, and the choice of prediction models (Plavšin et al.&nbsp;2021). Selecting an appropriate prediction model is a relatively straightforward approach to improve prediction accuracy among these factors. Traditional GS models like Genomic Best Linear Unbiased Prediction (GBLUP) and Ridge Regression (RR) have been foundational, yet they often fail to capture non-linear genetic interactions critical for complex traits like yield (Desta and Ortiz 2014). Emerging models such as Random Forest (RF) and Reproducing Kernel Hilbert Space (RKHS) offer potential improvements by accounting for these complexities . This study aims to explore the predictive capabilities of these advanced models, focusing exclusively on wheat yield (YLD) as a primary trait of interest.</p>
<p>The data for this analysis stems from a comprehensive dataset encompassing 250 spring wheat lines from diverse genetic backgrounds, evaluated under varying environmental conditions. Six statistical models, namely Ridge Regression (RR), Reproducing Kernel Hilbert Space (RKHS), Genomic Best Linear Unbiased Prediction (GBLUP), Least Absolute Shrinkage and Selection Operator (LASSO), Support Vector Machine (SVM), and Random Forest (RF), were evaluated to identify the optimal model for YLD. Through rigorous analysis and visualization of the genetic predictors of yield, we anticipate fostering a deeper understanding of GS’s potential to address pressing food security challenges.</p>
</section>
<section id="data-and-code" class="level1">
<h1>2. Data and Code</h1>
<p><strong>Plant Material</strong></p>
<p>This study involves 250 spring wheat varieties and elite lines, developed by breeding programs in the Northwestern Pacific region of the United States and the International Maize and Wheat Improvement Center (CIMMYT) in Mexico City, Mexico. The collection includes three market categories of spring wheat cultivated in the Americas: soft white spring, hard white spring, and hard red spring, with over 50% of the lines serving as foundational lines for regional variety development programs.</p>
<p><strong>Phenotypic Evaluation</strong></p>
<p>The wheat panel was evaluated across five distinct environments, labeled E1 to E5 (E1 = 2016, E2 = 2017, E3 = 2021, E4 = 2022, E5 = 2023), at a field trial location in Aberdeen, Idaho (42°56’36” N and 112°50’22” W). The trial layout was a randomized complete block design with two replicates. Each genotype was planted in 3.0 m plots consisting of seven rows, with a row spacing of 21 cm. Yield per hectare (kg/ha) was measured in four of these trials (E1, E2, E4, E5).</p>
<p><strong>Genotyping</strong></p>
<p>The population was genotyped using Illumina’s 90K iSelect SNPchip. Raw data was provided by the USDA/ARS Cereal Crops Research Unit and was analyzed using Genome Studio v2.0.5(Illumina 2010) for processing its raw data. Polymorphic markers were identified as exhibiting clear, distinct clusters in Genome Studio, with a minimum distance of 0.20 between the polar coordinates of normalized theta intensities. Markers were further filtered based on missing data (&gt;10%) and minor allele frequency (&lt;5%) using TASSEL v5.2.89 (Bradbury et al.&nbsp;2007).</p>
<p><strong>Data Dictionary</strong></p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 87%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Field</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ENT</td>
<td>Unique identifier for each wheat variety, numbered from 52001 to 52250</td>
<td>Integer</td>
</tr>
<tr class="even">
<td>Source</td>
<td>Source of the plant material, including universities (UI, UCD, WSU), CIMMYT, MSU, USDA, and other sources (commercial varieties and international germplasm)</td>
<td>String</td>
</tr>
<tr class="odd">
<td>YLD_E1</td>
<td>Yield in kilograms per hectare for environment E1 (2016)</td>
<td>Float</td>
</tr>
<tr class="even">
<td>YLD_E2</td>
<td>Yield in kilograms per hectare for environment E2 (2017)</td>
<td>Float</td>
</tr>
<tr class="odd">
<td>YLD_E4</td>
<td>Yield in kilograms per hectare for environment E4 (2022)</td>
<td>Float</td>
</tr>
<tr class="even">
<td>YLD_E5</td>
<td>Yield in kilograms per hectare for environment E5 (2023)</td>
<td>Float</td>
</tr>
<tr class="odd">
<td>YLD_BLUPs</td>
<td>Best Linear Unbiased Prediction (BLUP) values for yield, calculated from the yields of environments E1, E2, E4, and E5. NA indicates not applicable.</td>
<td>Float</td>
</tr>
</tbody>
</table>
</section>
<section id="results" class="level1">
<h1>3. Results</h1>
<p><strong>Phenotypic analysis</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"YLD.csv"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data[<span class="fu">grepl</span>(<span class="st">"^YLD"</span>, <span class="fu">names</span>(data))] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data[<span class="fu">grepl</span>(<span class="st">"^YLD"</span>, <span class="fu">names</span>(data))], as.numeric)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"YLD"</span>),</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Year_Rep"</span>,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Value"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> long_data <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">sub</span>(<span class="st">"-.*"</span>, <span class="st">""</span>, Year_Rep))  </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a vector of colors including the new one</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"YLD_BLUPs"</span> <span class="ot">=</span> <span class="st">"Red"</span>,<span class="st">"YLD_E3"</span> <span class="ot">=</span><span class="st">"#8DD3C7"</span>,<span class="st">"YLD_E4"</span> <span class="ot">=</span> <span class="st">"#FDB462"</span>,<span class="st">"YLD_E5"</span> <span class="ot">=</span><span class="st">"#80B1D3"</span>, <span class="st">"YLD_E1"</span><span class="ot">=</span><span class="st">"yellow"</span>, <span class="st">"YLD_E2"</span><span class="ot">=</span><span class="st">"#D8BFD8"</span>)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Density plot with manual colors</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> long_data, <span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Year)) <span class="sc">+</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>, <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Density"</span>,<span class="at">fill=</span><span class="st">"Environment"</span>) <span class="sc">+</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),       <span class="co"># Adjust the size of the legend title</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),        <span class="co"># Adjust the size of the legend text</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),       <span class="co"># Adjust the size of the x-axis title</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),       <span class="co"># Adjust the size of the y-axis title</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),        <span class="co"># Adjust the size of the x-axis text/labels</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)         <span class="co"># Adjust the size of the y-axis text/labels</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the plots</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 29%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th>Trait</th>
<th>Env</th>
<th>Mean</th>
<th>Range</th>
<th>IQR</th>
<th>CV</th>
<th>Skewness</th>
<th>Kurtosis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>YLD</td>
<td>E1</td>
<td>5687.207</td>
<td>3560.188-7753.867±839.68</td>
<td>1115.165</td>
<td>0.148</td>
<td>-0.258</td>
<td>-0.285</td>
</tr>
<tr class="even">
<td></td>
<td>E2</td>
<td>5528.63</td>
<td>4850.76-6181.51±272.1</td>
<td>356.24</td>
<td>0.05</td>
<td>-0.18</td>
<td>-0.22</td>
</tr>
<tr class="odd">
<td></td>
<td>E4</td>
<td>6012.449</td>
<td>5512.441-6517.149±178.2</td>
<td>216.375</td>
<td>0.03</td>
<td>-0.017</td>
<td>0.31</td>
</tr>
<tr class="even">
<td></td>
<td>E5</td>
<td>6630.67</td>
<td>5603.001-7432.273±327.87</td>
<td>428.973</td>
<td>0.049</td>
<td>-0.243</td>
<td>-0.11</td>
</tr>
<tr class="odd">
<td></td>
<td>BLUPs</td>
<td>6023.156</td>
<td>5340.134-6550.368±223.86</td>
<td>290.7</td>
<td>0.037</td>
<td>-0.292</td>
<td>-0.122</td>
</tr>
</tbody>
</table>
<p>Yield (YLD) is a critical agronomic trait determining the superiority of wheat varieties. The BLUPs for YLD ranged from 5340.134 to 6550.368 kg/ha. Lowest YLD was observed in E2, with a mean YLD of 6023.156 kg/ha, and highest YLD was observed in E5, with a mean YLD of 6630.67 kg/ha. The distribution YLD demonstrated the most significant variability, with a left-skewed and leptokurtic distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"YLD.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data[<span class="fu">grepl</span>(<span class="st">"^YLD"</span>, <span class="fu">names</span>(data))] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(data[<span class="fu">grepl</span>(<span class="st">"^YLD"</span>, <span class="fu">names</span>(data))], as.numeric)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ALL_cols <span class="ot">&lt;-</span> data[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(data)]  </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.numeric</span>(data[[i]])) {  </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    data[[i]][<span class="fu">is.na</span>(data[[i]])] <span class="ot">&lt;-</span> <span class="fu">mean</span>(data[[i]], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(ALL_cols, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(cor_matrix, <span class="at">method =</span> <span class="st">"color"</span>, <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The BLUPs values for YLD trait showed high correlations with the trait values across different environments, indicating their effectiveness in integrating phenotypic data from multiple environments for subsequent genetic analysis. Although the correlations between YLD BLUPs and YLD in some environments were slightly lower, they still represented the overall performance of YLD reasonably well</p>
<p><strong>Population Structure</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>pca_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"PCA.csv"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>source_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"UI"</span>, <span class="st">"UCD"</span>, <span class="st">"WSU"</span>, <span class="st">"CIMMYT"</span>, <span class="st">"MSU"</span>, <span class="st">"USDA"</span>, <span class="st">"Other"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>source_counts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">111</span>,<span class="dv">34</span>,<span class="dv">26</span>,<span class="dv">25</span>,<span class="dv">25</span>,<span class="dv">18</span>,<span class="dv">10</span>) </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>source_levels_with_counts <span class="ot">&lt;-</span> <span class="fu">paste</span>(source_levels, <span class="st">"("</span>, source_counts, <span class="st">")"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>pca_data<span class="sc">$</span>Source <span class="ot">&lt;-</span> <span class="fu">factor</span>(pca_data<span class="sc">$</span>Source, <span class="at">levels =</span> source_levels, <span class="at">labels =</span> source_levels_with_counts)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>source_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"gray"</span>, <span class="st">"purple"</span>, <span class="st">"orange"</span>, <span class="st">"black"</span>, <span class="st">"green"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">setNames</span>(source_colors, source_levels_with_counts) <span class="co"># 创建颜色与来源的映射</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(pca_data, <span class="at">x =</span> <span class="sc">~</span>PC1, <span class="at">y =</span> <span class="sc">~</span>PC2, <span class="at">z =</span> <span class="sc">~</span>PC3, <span class="at">color =</span> <span class="sc">~</span>Source, <span class="at">colors =</span> colors, <span class="at">type =</span> <span class="st">'scatter3d'</span>, <span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">scene =</span> <span class="fu">list</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pcomp1:6.3%'</span>,<span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">24</span>), <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>)),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pcomp2:5.4%'</span>,<span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">24</span>), <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>)),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Pcomp3:4.4%'</span>,<span class="at">titlefont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">24</span>), <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">4</span>))),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">''</span>), </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                       <span class="at">traceorder =</span> <span class="st">'normal'</span>, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                       <span class="at">font =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">10</span>), </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bgcolor =</span> <span class="st">'rgba(255, 255, 255, 0.5)'</span>, </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bordercolor =</span> <span class="st">'rgba(0, 0, 0, 0.5)'</span>, </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">borderwidth =</span> <span class="dv">1</span>)) </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b0c0e4063bf781124813" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b0c0e4063bf781124813">{"x":{"visdat":{"3e1c4cf464fb":["function () ","plotlyVisDat"]},"cur_data":"3e1c4cf464fb","attrs":{"3e1c4cf464fb":{"x":{},"y":{},"z":{},"mode":"markers","marker":{"size":2},"color":{},"colors":["blue","red","gray","purple","orange","black","green"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"","scene":{"xaxis":{"title":"Pcomp1:6.3%","titlefont":{"size":24},"tickfont":{"size":4}},"yaxis":{"title":"Pcomp2:5.4%","titlefont":{"size":24},"tickfont":{"size":4}},"zaxis":{"title":"Pcomp3:4.4%","titlefont":{"size":24},"tickfont":{"size":4}}},"legend":{"title":{"text":""},"traceorder":"normal","font":{"size":10},"bgcolor":"rgba(255, 255, 255, 0.5)","bordercolor":"rgba(0, 0, 0, 0.5)","borderwidth":1},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-15.44707,-32.215443,-16.725676,-31.754135000000002,-34.114998,-25.437819999999999,30.7364,12.394403000000001,32.696682000000003,28.283481999999999,-34.127659999999999,-26.139030000000002,2.837853,31.744309999999999,-27.874126,-34.234302999999997,-26.141508000000002,-15.015416999999999,6.1577845,-25.507345000000001,-2.3737596999999999,-24.751244,13.514343,-13.059426999999999,-36.655327,-16.555422,-19.228155000000001,-13.506015,-0.080756515000000001,-34.148421999999997,-32.833725000000001,-5.9327015999999997,-2.2751613000000002,-22.188621999999999,-34.932322999999997,-35.684531999999997,3.37927,15.980606999999999,20.893255,4.0348062999999996,-25.038225000000001,-33.173175999999998,-32.397174999999997,7.6078543999999999,3.3968352999999998,3.4977157000000001,22.538252,4.3195750000000004,-26.151678,-30.817905,-33.150309999999998,-4.641438,-4.6552170000000004,-2.7522893000000002,-28.143045000000001,-33.697285000000001,-34.916946000000003,2.6151635999999998,-4.7808989999999998,17.967721999999998,9.9866720000000004,-29.084271999999999,-26.574000999999999,-1.3397729,2.6979853999999999,18.338417,9.7098010000000006,-28.598984000000002,-32.613075000000002,-34.040855000000001,4.0631380000000004,-5.4622444999999997,21.374973000000001,-27.254856,-34.111812999999998,0.77722424000000001,-8.3078059999999994,24.622816,-33.282753,-14.368411999999999,21.511977999999999,18.709949999999999,23.324432000000002,-12.587868,-34.686836,-35.433765000000001,6.3781809999999997,13.9492855,21.044048,9.4665999999999997,-26.758223000000001,-32.525337,-35.709625000000003,4.8581104000000002,13.398648,-8.7945729999999998,-2.5803775999999998,-25.763437,-9.5053990000000006,-33.669322999999999,8.7263099999999998,-4.0912090000000001,25.551071,24.698063000000001,-20.581633,-31.574332999999999,-29.636189000000002,5.6699089999999996,8.8252670000000002,9.3851385000000001,25.169301999999998],"y":[5.4325159999999997,-0.9537428,-2.2932174000000001,-2.1842815999999998,-5.3369809999999998,0.24961805000000001,-21.477186,-17.123674000000001,-14.990904,-18.213013,-5.3662175999999997,-3.2536315999999998,-16.564637999999999,-20.743089999999999,-7.0848849999999999,-5.4005264999999998,0.55810004000000002,1.9770966999999999,-18.655273000000001,-2.7940119999999999,-12.128034,-8.2536179999999995,-12.919840000000001,2.1712560000000001,-12.155779000000001,-9.2090169999999993,-1.7411907,-6.9394030000000004,0.81045495999999995,-0.49211597000000001,1.5616874999999999,-12.130292000000001,-12.115602000000001,-2.0775247000000001,-10.592328999999999,-12.010438000000001,15.114459999999999,-8.9007199999999997,-7.8730019999999996,-18.282042000000001,1.960518,-11.532918,-9.4323149999999991,13.980288,-2.5771052999999999,-12.087624,-9.322972,-18.045162000000001,0.27866992000000002,-13.710611,-0.56884170000000001,-11.081284500000001,21.776909,6.5341449999999996,0.31358153,-10.3444805,-2.8767342999999999,-14.320601999999999,-11.671493,-13.677846000000001,-9.9830590000000008,-4.4473060000000002,1.3416958000000001,-12.234050999999999,-12.067278999999999,-10.729069000000001,-14.195751,0.82925450000000001,-4.0377865000000002,-0.09011458,-5.9656152999999996,-6.9769926,-23.267603000000001,-3.0326477999999999,-0.074817010000000003,-0.18793346999999999,-8.0725160000000002,-24.450583999999999,-11.853489,-0.18309998999999999,-17.601590999999999,-12.227496,-19.963304999999998,1.5649233,-9.3671589999999991,-8.1475220000000004,2.6815145,-16.511199999999999,-12.739903999999999,-15.974418999999999,-3.1992775999999998,-9.402704,-12.261108999999999,15.28533,-20.801134000000001,-3.4939034000000002,-0.93775379999999997,-3.7798501999999998,-5.4800972999999997,-8.4873940000000001,18.286814,8.4422920000000001,-16.015989999999999,-12.801297999999999,-6.0436845000000003,-8.2857489999999991,-11.321068,13.075087999999999,-12.584299,7.6024026999999998,-12.515234],"z":[-1.1977975000000001,-13.083921999999999,-21.301096000000001,-10.215434,-9.7248509999999992,-1.8971169000000001,-10.959839000000001,-14.816533,-13.420785,-25.165678,-9.6049059999999997,-8.7738370000000003,-7.1311099999999996,-15.780419999999999,-4.791728,-9.687659,-2.1290979999999999,-8.116384,-7.8235000000000001,-24.984978000000002,-6.1927839999999996,-21.183767,-12.979732,-18.723980000000001,-10.252635,-14.435516,-5.6060990000000004,-18.341882999999999,6.7289433000000001,-21.654924000000001,-12.776052,2.7078435000000001,12.412043000000001,-11.565509,-8.2643389999999997,-10.905849,3.56515,4.1922620000000004,-15.850847999999999,-20.095082999999999,-8.8534679999999994,-8.0977080000000008,-10.750939000000001,5.9495490000000002,1.9511746999999999,-8.5760470000000009,-17.524830000000001,-19.929808000000001,-16.799568000000001,-7.1679620000000002,-9.3795979999999997,12.69566,-5.549817,-0.61810743999999995,-6.8314680000000001,-9.6606799999999993,-11.221598,9.0404359999999997,10.890738000000001,-8.3429490000000008,-13.363706000000001,-20.121458000000001,-9.3912759999999995,13.661674,9.2340990000000005,-5.80633,-13.988038,-15.637366999999999,-13.274423000000001,-18.538612000000001,6.4942339999999996,6.2406782999999999,-26.033840000000001,-20.909174,-18.537545999999999,12.300948999999999,8.1885250000000003,-23.720053,-10.142035999999999,-6.7789792999999996,-5.8446373999999999,-4.8078390000000004,-24.608460999999998,-5.0871909999999998,-4.2634340000000002,-8.2318090000000002,-0.67402863999999996,-20.619629,-7.7599983000000003,-17.191117999999999,-10.760811,-3.7536402,-11.023362000000001,5.0917306,-16.810400000000001,8.0431740000000005,5.1431893999999998,-7.0369020000000004,-3.3642395,-8.5952120000000001,0.46991317999999999,-3.6828197999999999,-10.50539,-7.8678675,-4.7066480000000004,-2.0850293999999998,-9.3858169999999994,8.129607,3.121146,-16.941382999999998,-8.0725510000000007],"mode":"markers","marker":{"color":"rgba(0,0,255,1)","size":2,"line":{"color":"rgba(0,0,255,1)"}},"type":"scatter3d","name":"UI(111)","textfont":{"color":"rgba(0,0,255,1)"},"error_y":{"color":"rgba(0,0,255,1)"},"error_x":{"color":"rgba(0,0,255,1)"},"line":{"color":"rgba(0,0,255,1)"},"frame":null},{"x":[10.331939,10.350484,9.9852980000000002,10.26037,23.321103999999998,-2.8497617000000002,-7.7105516999999999,0.45173219999999997,11.636003000000001,15.486513,2.1843306999999998,12.419547,11.741676999999999,8.6108499999999992,2.1994486000000002,9.3472089999999994,5.0745639999999996,6.6936817,1.8293661000000001,-3.454688,-7.6372156000000002,5.4884019999999998,15.571799,9.2991489999999999,2.4783236999999998,-7.6991443999999998,10.533604,11.392241,7.9581784999999998,6.7672160000000003,19.834478000000001,3.5829034000000002,16.416284999999998,17.663799999999998],"y":[1.7784711,1.7674936999999999,2.1048290000000001,1.6886399000000001,-4.0777840000000003,14.355981,22.786284999999999,-6.0081015000000004,-10.148372,-11.809514999999999,3.4307196000000002,-7.2339387000000004,-13.161492000000001,-3.8598330000000001,1.4187669000000001,-0.45076667999999998,-11.091713,-13.904216999999999,0.90905314999999998,6.5677047000000002,11.621297,-3.3049192000000001,-7.1848679999999998,-11.09825,-6.5387244000000004,22.772936000000001,-12.592233999999999,-5.0510529999999996,-4.7882680000000004,-11.398645999999999,-3.8075022999999999,1.2230216,8.5927105000000008,1.6075172],"z":[24.862335000000002,24.888342000000002,25.30855,24.472479,7.7937079999999996,7.4946089999999996,-2.8421736000000002,7.6137794999999997,15.275496499999999,23.850489,5.3668393999999999,15.69361,17.790863000000002,2.9235191,9.1700809999999997,18.537849999999999,-4.6311045000000002,-3.453789,12.832621,17.989550000000001,15.075472,19.502362999999999,9.6184224999999994,5.3304935000000002,4.2859863999999996,-2.8303337000000002,17.600425999999999,6.8906926999999998,10.397311,5.8900747000000004,10.460248999999999,10.232813,5.3755280000000001,5.1617850000000001],"mode":"markers","marker":{"color":"rgba(255,0,0,1)","size":2,"line":{"color":"rgba(255,0,0,1)"}},"type":"scatter3d","name":"UCD(34)","textfont":{"color":"rgba(255,0,0,1)"},"error_y":{"color":"rgba(255,0,0,1)"},"error_x":{"color":"rgba(255,0,0,1)"},"line":{"color":"rgba(255,0,0,1)"},"frame":null},{"x":[15.445591,21.627783000000001,29.526523999999998,32.872399999999999,27.013877999999998,27.143129999999999,27.263338000000001,33.538531999999996,24.793130000000001,13.793333000000001,23.00347,25.196321000000001,26.753692999999998,26.285796999999999,1.1625273,25.080645000000001,32.611150000000002,25.599209999999999,26.271559,31.847624,29.125637000000001,6.8010539999999997,3.2883718000000002,2.1246442999999999,-9.9553720000000006,-19.167449999999999],"y":[30.235800000000001,16.441655999999998,-26.221402999999999,-22.423449000000002,-11.249644,14.563737,-6.0535819999999996,-1.8252103,-20.684367999999999,-8.1396599999999992,-24.725708000000001,-17.812957999999998,-4.2090063000000004,-20.690424,-19.286701000000001,14.604225,-15.388866,16.037745999999999,13.313015999999999,-22.471771,-15.475742,-8.8630420000000001,-18.426226,-12.879953,8.8997250000000001,-2.4257561999999999],"z":[-17.686216000000002,-13.078222,-21.244441999999999,-22.065659,-10.5785055,-4.2840809999999996,-9.4842549999999992,-13.858162999999999,-12.110533999999999,1.3436513000000001,-13.786782000000001,-5.1296425000000001,-9.0717960000000009,-8.0590449999999993,-12.209638,-4.3133736000000003,-16.940435000000001,-3.9105713,-3.7007564999999998,-12.956204,-17.521827999999999,7.4325099999999997,-12.681227,1.7299523000000001,-13.014701000000001,-5.2628507999999998],"mode":"markers","marker":{"color":"rgba(190,190,190,1)","size":2,"line":{"color":"rgba(190,190,190,1)"}},"type":"scatter3d","name":"WSU(26)","textfont":{"color":"rgba(190,190,190,1)"},"error_y":{"color":"rgba(190,190,190,1)"},"error_x":{"color":"rgba(190,190,190,1)"},"line":{"color":"rgba(190,190,190,1)"},"frame":null},{"x":[3.4693797000000002,2.7668366,2.7281816000000001,6.5784326000000002,-5.3880600000000003,2.6524071999999999,3.0325405999999999,-1.8679768000000001,-4.3175496999999998,-1.4257808999999999,3.9288826000000001,-6.0802420000000001,14.226685,4.5558269999999998,-6.8894479999999998,-5.9963220000000002,-5.4991726999999999,0.91549873000000004,-1.0155240000000001,4.8036440000000002,-4.0041450000000003,-2.6468272000000002,-5.1049179999999996,-2.8608408000000001,1.0689995000000001],"y":[12.056355999999999,1.3499368,10.476063,-3.185622,4.9550380000000001,10.986326,-1.3894359999999999,1.615791,7.1805944000000004,7.8987119999999997,2.5683221999999999,0.41214933999999998,-4.5361485000000004,5.6590119999999997,10.067966999999999,5.9413799999999997,5.555053,1.5450457,-1.1663504,7.8950189999999996,1.4675418,0.054976758000000001,-0.15199952,14.592993,0.50347410000000004],"z":[13.048162,36.873289999999997,27.043780000000002,27.638445000000001,22.32789,19.314164999999999,10.413245999999999,30.302948000000001,28.933947,5.684088,22.775503,16.843958000000001,12.754771,11.931811,25.088401999999999,19.434498000000001,28.313654,11.595468500000001,25.809564999999999,18.231596,31.212430999999999,12.747389,17.194794000000002,23.972273000000001,17.637953],"mode":"markers","marker":{"color":"rgba(160,32,240,1)","size":2,"line":{"color":"rgba(160,32,240,1)"}},"type":"scatter3d","name":"CIMMYT(25)","textfont":{"color":"rgba(160,32,240,1)"},"error_y":{"color":"rgba(160,32,240,1)"},"error_x":{"color":"rgba(160,32,240,1)"},"line":{"color":"rgba(160,32,240,1)"},"frame":null},{"x":[14.9524765,8.7085699999999999,10.531169,2.5114887000000001,15.483193999999999,14.633379,11.7476425,4.9501552999999996,7.0606746999999999,8.5779969999999999,2.0666549999999999,18.489698000000001,16.831869999999999,-2.187046,13.936149,2.8683323999999999,24.516694999999999,4.9901704999999996,2.9720092,5.0860799999999999,12.759233,25.265785000000001,25.576712000000001,5.6842421999999999,16.155424],"y":[21.089008,21.405348,38.41648,68.119020000000006,42.675423000000002,27.351520000000001,46.463912999999998,67.904979999999995,41.662135999999997,49.778216999999998,67.722176000000005,32.972569999999997,-14.463366000000001,16.720654,23.563808000000002,67.892169999999993,-7.4330005999999997,66.508223999999998,58.441417999999999,36.051814999999998,39.783596000000003,7.5386214000000002,-19.993559000000001,26.400971999999999,16.165346],"z":[-8.4393630000000002,-13.020458,-11.799671,-15.607934999999999,-15.050223000000001,-10.397368999999999,-18.498045000000001,-11.516997999999999,-14.907904,-16.382273000000001,-15.491231000000001,-12.642913999999999,-7.4299911999999999,-9.8192179999999993,2.9294585999999998,-15.428326999999999,-18.769846000000001,-11.920992999999999,-16.455976,-13.656017,-16.332684,-25.257930000000002,-20.245052000000001,-7.4550346999999997,-9.9215710000000001],"mode":"markers","marker":{"color":"rgba(255,165,0,1)","size":2,"line":{"color":"rgba(255,165,0,1)"}},"type":"scatter3d","name":"MSU(25)","textfont":{"color":"rgba(255,165,0,1)"},"error_y":{"color":"rgba(255,165,0,1)"},"error_x":{"color":"rgba(255,165,0,1)"},"line":{"color":"rgba(255,165,0,1)"},"frame":null},{"x":[-6.3194184,-3.8800694999999998,-2.2793313999999998,6.6069335999999996,-2.2487154,-5.8572664000000003,4.1128030000000004,1.5415574000000001,0.58936999999999995,0.78647420000000001,1.9260746,0.81191559999999996,-6.0015507000000001,-6.4647436000000003,-2.6004200000000002,-5.6300793000000002,-5.1696115000000002,-5.3408246000000004],"y":[0.57646114000000004,-1.8622477,1.1120243000000001,-4.0835147000000003,1.6553922000000001,0.83188260000000003,-0.55163443000000001,-1.6444240999999999,-2.7937584000000002,-8.4223169999999996,-7.5397249999999998,-0.39789799999999997,2.5595899000000002,1.023379,-3.0600922000000002,-5.9853997000000003,-4.9478374000000001,-4.8451667],"z":[24.913435,25.037645000000001,22.349205000000001,24.784859999999998,21.875586999999999,24.545615999999999,24.182552000000001,17.905532999999998,16.842466000000002,16.242228000000001,18.913592999999999,22.812211999999999,26.193314000000001,24.623163000000002,23.449649999999998,21.055693000000002,21.600753999999998,21.462729],"mode":"markers","marker":{"color":"rgba(0,0,0,1)","size":2,"line":{"color":"rgba(0,0,0,1)"}},"type":"scatter3d","name":"USDA(18)","textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"frame":null},{"x":[-0.67201655999999999,14.712088,-10.867772,-5.5484669999999996,-2.4553988000000002,-5.92584,-10.523057,-10.049200000000001,-2.3688145,-5.9304842999999998],"y":[-11.863670000000001,30.649977,3.0684136999999998,1.9744809999999999,0.1016986,1.7638309999999999,7.420274,7.9214362999999999,-4.1139846000000002,-12.124072],"z":[3.1974893,-3.6412756000000002,20.335906999999999,22.053621,25.094866,21.922522000000001,29.362362000000001,29.548456000000002,7.9406119999999998,2.7131764999999999],"mode":"markers","marker":{"color":"rgba(0,255,0,1)","size":2,"line":{"color":"rgba(0,255,0,1)"}},"type":"scatter3d","name":"Other(10)","textfont":{"color":"rgba(0,255,0,1)"},"error_y":{"color":"rgba(0,255,0,1)"},"error_x":{"color":"rgba(0,255,0,1)"},"line":{"color":"rgba(0,255,0,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Principal component analysis (PCA) based on the genotypic data revealed a clear population structure among the 249 spring wheat lines (Fig. 5). The first three principal components (PCs) explained 6.3%, 5.4%, and 4.4% of the total genetic variance, respectively. The 3D PCA plot showed distinct clustering of lines according to their sources. The number of lines within each cluster ranged from 10 (Other) to 111 (UI). The largest cluster consisted of 111 lines from the University of Idaho (UI), followed by 34 lines from UC Davis (UCD) and 26 lines from Washington State University (WSU).</p>
<table class="table">
<thead>
<tr class="header">
<th>Df</th>
<th>Sum Sq</th>
<th>Mean Sq</th>
<th>F value</th>
<th>Pr(&gt;F)</th>
<th>R<sup>2</sup></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>6</td>
<td>1383462.467</td>
<td>230577.0778</td>
<td>5.068379905</td>
<td>6.41E-05</td>
<td>11.1%</td>
</tr>
<tr class="even">
<td>242</td>
<td>11009366.68</td>
<td>45493.25073</td>
<td>NA</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Analysis of variance (ANOVA) revealed that the population structure had significant effects on all five traits analyzed (P &lt; 0.001) .</p>
<p><strong>Comparison of Genomic Prediction Models</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>trait<span class="ot">=</span><span class="fu">c</span>(<span class="st">"YLD"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(<span class="st">"compare.YLD.16Modify.17.22.23.BLUP.csv"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>data_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(data)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data_melted, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>)) <span class="sc">+</span> </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Model"</span>, <span class="at">y =</span> <span class="fu">paste0</span>(<span class="st">"Prediction Accuracy for "</span>,trait), <span class="at">title =</span> <span class="st">""</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Six statistical models, including GBLUP, RKHS, RF, RR LASSO, and SVM, were evaluated using a five-fold cross-validation scheme with 50 replications to identify the optimal model for predicting HD, PHT, TKW, tSNS, and YLD based on the BLUPs of phenotypic data. The SVM model consistently showed the lowest prediction accuracies，while RKHS and RF demonstrated similar and superior performance compared to the other models, including the widely used GBLUP and RR</p>
<p>Considering the comparable performance of RKHS and RF, we selected RF as the optimal model for genomic prediction in this study. Second, Charmet et al.(2020a) previously evaluated the computational efficiency of various prediction methods using a set of 47,839 markers and 100 independent 10-fold cross-validations. They found that RF (382 minutes) was considerably less computationally intensive than RKHS (637 minutes), making RF a more practical choice for large-scale genomic prediction applications.</p>
<p><strong>Testing Prediction across Environment</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"merged_GP502-RF-YLD.16Modify.17.22.23_filtered.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>data_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(data, <span class="at">key =</span> <span class="st">"Measurement"</span>, <span class="at">value =</span> <span class="st">"Value"</span>, BLUPs_RF<span class="sc">:</span>E5_RF)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>my_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"BLUPs_RF"</span> <span class="ot">=</span> <span class="st">"Red"</span>, <span class="st">"E3_RF"</span> <span class="ot">=</span><span class="st">"#8DD3C7"</span>, <span class="st">"E4_RF"</span> <span class="ot">=</span> <span class="st">"#FDB462"</span>, <span class="st">"E5_RF"</span> <span class="ot">=</span><span class="st">"#80B1D3"</span>, <span class="st">"E1_RF"</span><span class="ot">=</span><span class="st">"yellow"</span>, <span class="st">"E2_RF"</span><span class="ot">=</span><span class="st">"#D8BFD8"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data_long, <span class="fu">aes</span>(<span class="at">x =</span> ...<span class="dv">2</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>, <span class="at">y =</span> Value, <span class="at">fill =</span> Measurement)) <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> my_colors) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">""</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Training Environment"</span>, <span class="at">y =</span> <span class="st">"Prediction Accuracy for YLD"</span>, <span class="at">fill=</span><span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>),   </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="cn">NA</span>), </span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),       </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),        </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),       </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),       </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">angle =</span> <span class="dv">0</span>), </span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),        </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>        <span class="co">#legend.position = "null",                    </span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>))         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 28%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">TRAITS</th>
<th style="text-align: left;">TRAINING ENVIRONMENTS</th>
<th style="text-align: left;">PREDICTION ENVIRONMENTS</th>
<th style="text-align: left;">PREDICTION ACCURACIES A</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">YLD</td>
<td style="text-align: left;">BLUPs</td>
<td style="text-align: left;">BLUPs</td>
<td style="text-align: left;">0.424</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E1</td>
<td style="text-align: left;">0.369</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E2</td>
<td style="text-align: left;">0.325</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E4</td>
<td style="text-align: left;">0.189</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E5</td>
<td style="text-align: left;">0.240</td>
</tr>
<tr class="even">
<td style="text-align: left;">YLD</td>
<td style="text-align: left;">E1</td>
<td style="text-align: left;">BLUPs</td>
<td style="text-align: left;">0.288</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E1</td>
<td style="text-align: left;">0.565</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E2</td>
<td style="text-align: left;">0.277</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E4</td>
<td style="text-align: left;">0.109</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E5</td>
<td style="text-align: left;">-0.052</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YLD</td>
<td style="text-align: left;">E2</td>
<td style="text-align: left;">BLUPs</td>
<td style="text-align: left;">0.319</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E1</td>
<td style="text-align: left;">0.343</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E2</td>
<td style="text-align: left;">0.360</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E4</td>
<td style="text-align: left;">0.140</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E5</td>
<td style="text-align: left;">0.041</td>
</tr>
<tr class="even">
<td style="text-align: left;">YLD</td>
<td style="text-align: left;">E4</td>
<td style="text-align: left;">BLUPs</td>
<td style="text-align: left;">0.161</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E1</td>
<td style="text-align: left;">0.242</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E2</td>
<td style="text-align: left;">0.129</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E4</td>
<td style="text-align: left;">0.078</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E5</td>
<td style="text-align: left;">0.058</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YLD</td>
<td style="text-align: left;">E5</td>
<td style="text-align: left;">BLUPs</td>
<td style="text-align: left;">0.259</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E1</td>
<td style="text-align: left;">0.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E2</td>
<td style="text-align: left;">0.053</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E4</td>
<td style="text-align: left;">0.127</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">E5</td>
<td style="text-align: left;">0.395</td>
</tr>
</tbody>
</table>
<p>In this study, we investigated the prediction accuracy of yield-related traits (HD, PHT, TKW, and tSNS) and yield (YLD) across different environments using the optimal model determined in the previous section (Random Forest with 80% of the population as the training set). Prediction accuracies are reported as the median value.</p>
<p>Single-environment models were trained by training and predicting within the same environment. For YLD, the prediction accuracies were highest for environment E1 and BLUPs, respectively. BLUPs outperformed 80% of the evaluation environments.When models were trained in one environment and used to predict in different environments, substantial variation in prediction accuracy was observed across environment combinations for all traits. For YLD, prediction accuracy ranged from -0.052 to 0.565 for different training-testing environment combinations, and from 0.189 to 0.424 when using BLUPs to train the model.Overall, BLUPs were best suited for training models to predict values in unknown environments, whether using single-environment models or cross-environment models.</p>
</section>
<section id="conclusion" class="level1">
<h1>4. Conclusion</h1>
<p>Wheat is a staple food crop worldwide, with its yield improvement being crucial for food security. Genomic selection accelerates the breeding process and enhances genetic gains in wheat. This study demonstrated the potential of genomic prediction models, particularly Random Forest, in predicting yield. And BLUPs data is the best data set for training and prediction.</p>
</section>
<section id="reference" class="level1">
<h1>5. Reference</h1>
<p>Bradbury PJ, Zhang Z, Kroon DE, Casstevens TM, Ramdoss Y, and Buckler ES. TASSEL: software for association mapping of complex traits in diverse samples. Bioinformatics. 2007:23(19):2633–2635. https://doi.org/10.1093/bioinformatics/btm308 Charmet G, Tran L-G, Auzanneau J, Rincent R, and Bouchet S. BWGS: AR package for genomic selection and its application to a wheat breeding programme. PloS one. 2020:15(4):e0222733. https://doi.org/10.1371/journal.pone.0222733 Desta ZA and Ortiz R. Genomic selection: genome-wide prediction in plant improvement. Trends in plant science. 2014:19(9):592–601. https://doi.org/10.1016/j.tplants.2014.05.006 Heffner EL, Sorrells ME, and Jannink J-L. Genomic Selection for Crop Improvement. Crop Science. 2009:49(1):1–12. https://doi.org/10.2135/cropsci2008.08.0512 Illumina. Introduction to GenomeStudio Software. 2010. Plavšin I, Gunjača J, Šatović Z, Šarčević H, Ivić M, Dvojković K, and Novoselović D. An overview of key factors affecting genomic selection for wheat quality traits. Plants. 2021:10(4):745. https://doi.org/10.3390/plants10040745 Zhang T, He Y, DePauw R, Jin Z, Garvin D, Yue X, Anderson W, Li T, Dong X, Zhang T, et al.&nbsp;Climate change may outpace current wheat breeding yield improvements in North America. Nature Communications. 2022:13(1):5591. https://doi.org/10.1038/s41467-022-33265-1</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>